    'AdvancedFilter # 1 - Semaine
    
    'Effacer les données de la dernière utilisation
    ws.Range("T16:T20").ClearContents
    ws.Range("T16").value = "Dernière utilisation: " & Format$(Now(), "yyyy-mm-dd hh:mm:ss")
    
    'Définir le range pour la source des données en utilisant un tableau
    Dim rngData as Range
	Set rngData = ws.Range("tblTEC_TDB_data[#All]")
    ws.Range("T17").value = rngData.Address
    
    'Définir le range des critères
    Dim rngCriteria as Range
	Set rngCriteria = ws.Range("S2:U3")
    ws.Range("T18").value = rngCriteria.Address
    
    'Définir le range des résultats et effacer avant le traitement
    Dim rngResult as range
	Set rngResult = ws.Range("W1").CurrentRegion
    rngResult.Offset(1, 0).Clear
    Set rngResult = ws.Range("W1").CurrentRegion
    ws.Range("T19").value = rngResult.Address
    
    rngData.AdvancedFilter _
                action:=xlFilterCopy, _
                criteriaRange:=rngCriteria, _
                CopyToRange:=rngResult, _
                Unique:=False
        
    'Quels sont les résultats ?
	Dim lastUsedRow as long
    lastUsedRow = ws.Cells(ws.rows.count, "W").End(xlUp).row
    ws.Range("T20").value = lastUsedRow - 1 & " lignes"
    
    'Est-il nécessaire de trier les résultats ?
    If lastUsedRow > 2 Then
        With ws.Sort 'Sort - ID, Date, TecID
            .SortFields.Clear
            'First sort On ProfID
            .SortFields.Add key:=ws.Range("W2"), _
                SortOn:=xlSortOnValues, _
                Order:=xlAscending, _
                DataOption:=xlSortNormal
            'Second, sort On Date
            .SortFields.Add key:=ws.Range("Y2"), _
                SortOn:=xlSortOnValues, _
                Order:=xlAscending, _
                DataOption:=xlSortNormal
            'Third, sort On TecID
            .SortFields.Add key:=ws.Range("Z2"), _
                SortOn:=xlSortOnValues, _
                Order:=xlAscending, _
                DataOption:=xlSortNormal
            .SetRange wshTEC_Local.Range("W2:AD" & lastResultRow)
            .Apply 'Apply Sort
         End With
    End If
	
	'Libérer les objets
    Set rngCriteria = Nothing
    Set rngData = Nothing
    Set rngReseult = Nothing
    Set ws = Nothing
    

